<body>
  <!DOCTYPE html>
<html lang="en-us">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="" name="keywords">
<meta content="2018 Breach Data - Eric Alexander" property="og:title">
<title>2018 Breach Data | Eric Alexander</title>
<link rel="stylesheet" href="http://ericalexander.org/css/style.css">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">


  <section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="http://ericalexander.org/"><h1 class="title is-4">Eric Alexander</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/ericalexanderorg">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://www.linkedin.com/in/ericalexanderorg">
            <span class="icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://www.reddit.com/user/ericalexander303">
            <span class="icon">
              <i class="fa fa-reddit"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

  <section class="section">
    <div class="container">
      <h2 class="subtitle is-6">December 26, 2018</h2>
      <h1 class="title">2018 Breach Data</h1>
      
      <div class="content">
        

<blockquote>
<p>If you know the enemy and know yourself, you need not fear the result of a hundred battles. If you know yourself but not the enemy, for every victory gained you will also suffer a defeat. If you know neither the enemy nor yourself, you will succumb in every battle.
-Sun Tsu, The Art of War</p>
</blockquote>

<p>Some advice on preventing about 70% of the incidents I see over in <a href="https://www.reddit.com/r/securitybreach/">/r/securitybreach</a>, a sub reddit started to help answer the questions: What&rsquo;s the enemy after? How do they go about trying to get it?</p>

<h2 id="account-compromise">Account Compromise</h2>

<p>Approximately 30% of the incidents I’ve seen stem from an Account Compromise: Credentials were compromised and now there&rsquo;s unauthorized access to data.</p>

<p>The tactics are basic password spraying: Grab a combo list like Exploit.in and <a href="https://www.tripwire.com/state-of-security/featured/new-type-brute-force-attack-office-365-accounts/">spray those creds across multiple targets.</a></p>

<p>There&rsquo;s plenty of ways to mitigate. If I could only recommend 1 way, hands down, it would be MFA. <a href="https://krebsonsecurity.com/2018/07/google-security-keys-neutralized-employee-phishing/">U2F</a> &gt; <a href="https://www.keycloak.org/docs/3.3/server_admin/topics/authentication/otp-policies.html">TOTP</a> &gt; Any MFA &gt; no MFA. Don&rsquo;t over think MFA,  just enable it everywhere you can.</p>

<h2 id="broken-access-control">Broken Access Control</h2>

<blockquote>
<p>“Nobody wants to hack us”</p>
</blockquote>

<p>About 20% of incidents are due to broken access control, yet there’s more to the story and the motivation is possibly more interesting. The majority of broken access control incidents I&rsquo;ve seen are schadenfruede motivated.</p>

<p>Maybe you don&rsquo;t process credit cards or crypto currency. Maybe you don&rsquo;t store any personal data. Doesn&rsquo;t matter, there&rsquo;s a company or consultant out there looking for press and they&rsquo;d love to find your <a href="https://www.theregister.co.uk/2017/12/21/aws_s3_alteryx_bungle/">open S3 bucket</a>, <a href="https://www.wired.com/story/exactis-database-leak-340-million-records/">elastic search db</a>, or <a href="https://techcrunch.com/2018/11/13/kars4kids-data-breach/">mongodb</a>.</p>

<p>How are you doing on those <a href="https://en.wikipedia.org/wiki/The_CIS_Critical_Security_Controls_for_Effective_Cyber_Defense">SANS Critical Security Controls</a>? Number 1 is inventory. You can’t protect what you can’t see. Simply running <a href="https://github.com/nccgroup/Scout2">Scout2</a> and acting on that insight would prevent 50% or more of the Broken Access Control incidents I see.</p>

<h2 id="insufficient-logging-monitoring">Insufficient Logging &amp; Monitoring</h2>

<p>Over 40% of incidents are money related and about 30% are after credit card data. Magecart actors have found a chink in the PCI armor and it’s called javascript includes.
How does it work? Simple: Compromise javascript included on a checkout page and siphon off credit card data.</p>

<p>This one, sorry, I don&rsquo;t have concrete insight into Magecart tactics. I&rsquo;ve got a hunch that there&rsquo;s not a strong culture of peer reviews or CI/CD in the victim environments.</p>

<p>The <a href="https://builttoadapt.io/the-three-r-s-of-enterprise-security-rotate-repave-and-repair-f64f6d6ba29d">3 Rs</a> create an environment that&rsquo;s inhospitable to unauthorized changes and a culture of <a href="https://smartbear.com/learn/code-review/agile-code-review-process/">peer reviews</a> ensures a minimum of 2 people understand the change.</p>

<p>At the least, make sure you have sufficient logging &amp; monitoring in place to know when a change happened, authorized or not.</p>

<h2 id="apt-tactics">APT Tactics</h2>

<p>APT, maybe a nation state figured it out but now every script kiddie knows how to do it. I find APT tactics interesting, partially due to the asymmetric problem of defense, partially because &ndash; thanks to open source tooling &ndash; the methods are easy to execute, and mostly because it&rsquo;s a great example of turning your enemies strength (Active Directory) into their weakness.</p>

<p>Side note: <a href="http://classics.mit.edu/Tzu/artwar.html">The Art of War</a> is possibly the best security book written. OK, back to APT.</p>

<p>The one thing I&rsquo;d recommend: Run through it yourself in your environment. Once you see how it’s done you will “know the enemy” and can leverage what you know about your environment &ndash; know thyself &ndash; to implement IOCs.</p>

<p>Here&rsquo;s a simple receipe:</p>

<ul>
<li>Use Metasploit as your C&amp;C</li>
<li>Use <a href="https://github.com/trustedsec/unicorn">Unicorn</a> to generate a payload with a good chance of avoiding AV detection.</li>
<li>Find a list of targets on LinkedIn.</li>
<li>Phish your list. Email them a link to your Unicorn payload and a simple message to trick them into running.</li>
<li>Now you’re on the network. Use <a href="https://github.com/EmpireProject/Empire">powershell empire</a> to find a logged in domain admin.</li>
<li>Game over</li>
</ul>

<h2 id="what-s-that-sound">What&rsquo;s that sound?</h2>

<p>It&rsquo;s old hats &ndash; grey beards? &ndash; grumbling: Nothing new here, old news. Maybe, but if it&rsquo;s old news then why&rsquo;s it still effective?  Incident trend data shouldn&rsquo;t be the domain of marketing teams trying to push the next silver bullet. Help me out over in <a href="https://www.reddit.com/r/securitybreach/">/r/securitybreach</a>.</p>

<blockquote>
<p>The general who wins the battle makes many calculations in his temple before the battle is fought. The general who loses makes but few calculations beforehand.</p>
</blockquote>

      </div>
    </div>
  </section>
  


  <section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="http://ericalexander.org">Eric Alexander</a> 2019</p>
  </div>
</section>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/dockerfile.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-87327219-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



</body>
